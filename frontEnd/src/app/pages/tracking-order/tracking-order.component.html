<app-navigation-bar></app-navigation-bar>

<h1 style="font-weight: bold; font-size: 30px; margin-left: 42%; margin-top: 40px; color: #3B3A58; margin-bottom: 10px;">Track My Order</h1>
<p style="margin-left: 200px; margin-right: 200px; font-size: large;">
    To track your order please enter your Order ID in the box below and press the "Track" button. This was given to you on your receipt and in the confirmation email you should have received.
</p>

<div class="max-w-sm mx-auto" style="margin-top: 30px; margin-bottom: 20px;">
    <div class="flex-container" style="display: flex; gap: 30px; justify-content: center; align-items: flex-start;">
        <div>
            <label for="orderId" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Order Id</label>
            <input [(ngModel)]="orderId" type="text" id="orderId" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" required />
        </div>
        <div>
            <label for="email" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Billing email</label>
            <input [(ngModel)]="email" type="email" id="email" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="framecrafted@gmail.com" required />
        </div>
    </div>

    <div style="text-align: center; margin-top: 40px;">
        <button (click)="trackOrder()" type="button" class="bg-pink-300 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800" style="background-color: #D8A7B1; color: #9569B2; font-weight: bold; font-size: medium;">Track</button>
    </div>
</div>

<!-- Track Order Modal with Stepper -->
<div id="orderModal" *ngIf="showModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000;">
    <div style="background: #fff; margin: 10% auto; padding: 20px; width: 50%; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); position: relative;">
        <button (click)="closeModal()" style="position: absolute; top: 10px; right: 10px; background: transparent; border: none; font-size: 24px; cursor: pointer; color: #000;">&times;</button>

        <h2 style="font-size: 24px; font-weight: bold; text-align: center; color: #333;">Order Details</h2>

        <!-- Stepper for Order Status -->
        <div style="margin-top: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div *ngFor="let status of statuses; let i = index" style="text-align: center;">
                    <div [ngStyle]="{ 
                        'background-color': i <= currentStatusIndex ? '#D8A7B1' : '#e0e0e0',
                        'color': i <= currentStatusIndex ? '#fff' : '#000',
                        'border-radius': '50%',
                        'width': '40px',
                        'height': '40px',
                        'line-height': '40px',
                        'margin': 'auto'
                    }">
                        {{ i + 1 }}
                    </div>
                    <p style="margin-top: 10px; font-size: 14px;">{{ status }}</p>
                </div>
            </div>

            <div style="height: 4px; background-color: #e0e0e0; position: relative; margin: 10px 0;">
                <div [style.width.%]="(currentStatusIndex + 1) / statuses.length * 100" style="height: 100%; background-color: #D8A7B1;"></div>
            </div>
        </div>

        <div style="font-size: 18px; margin-top: 20px; color: #555;">
            <p><strong>Item Code:</strong> {{ orderDetails.itemCode }}</p>
            <p><strong>Price:</strong> {{ orderDetails.price }}</p>
            <p><strong>Status:</strong> {{ statuses[currentStatusIndex] }}</p>
        </div>

        <div style="text-align: center; margin-top: 20px;">
            <button (click)="openUpdateModal()" style="background: #D8A7B1; color: #9569B2; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px;">Update Order</button>
            <button (click)="cancelOrder()" style="background: #ff6b6b; color: #fff; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; margin-left: 10px;">Cancel Order</button>
        </div>
    </div>
</div>

<!-- Update Order Modal -->
<div  id="updateModal" *ngIf="showUpdateModal" style="position: fixed; overflow-y: auto; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000;">
    <div  style="background: #fff; margin: 10% auto; padding: 20px; width: 50%; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); position: relative;">
        <button (click)="closeUpdateModal()" style="position: absolute; top: 10px; right: 10px; background: transparent; border: none; font-size: 24px; cursor: pointer; color: #000;">&times;</button>

        <h2 style="font-size: 24px; font-weight: bold; text-align: center; color: #333;">Update Order</h2>
        <div style="display: flex; gap: 16px;">
            <div style="flex: 1;">
                <label style="display: block; margin-bottom: 8px; font-weight: bold;">Frame Code (Item Code):</label>
                <input [(ngModel)]="orderDetails.itemCode" type="text" readonly />
            </div>
            <div style="flex: 1;">
                <label style="display: block; margin-bottom: 8px; font-weight: bold;">Price:</label>
                <input [(ngModel)]="orderDetails.price" type="text" readonly />
            </div>
        </div>
        <div style="display: flex; gap: 16px; margin-top: 20px;">
            <div>
                <label style="display: block; margin-bottom: 8px; font-weight: bold;">Email</label>
                <input [(ngModel)]="orderDetails.emailAddress" type="email" style="width: 100%;" required />
            </div>
            <div>
                <label style="display: block; margin-bottom: 8px; font-weight: bold;">Phone Number</label>
                <input [(ngModel)]="orderDetails.phoneNumber" type="text" style="width: 100%;" required />
            </div>
        </div>
        <div style="margin-top: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: bold;">Address</label>
            <textarea [(ngModel)]="orderDetails.address" rows="3" style="width: 100%;" required></textarea>
        </div>
        <div style="margin-top: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: bold;">Photo URL</label>
            <input [(ngModel)]="orderDetails.photoUrl" type="url" style="width: 100%;" required />
        </div>
        <div style="margin-top: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: bold;">Comments</label>
            <textarea [(ngModel)]="orderDetails.comments" rows="3" style="width: 100%;"></textarea>
        </div>
        <div style="text-align: center; margin-top: 20px;">
            <button (click)="updateOrderDetails()" style="background: #D8A7B1; color: #9569B2; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px;">Update</button>
        </div>
    </div>
</div>

<app-footer></app-footer>
